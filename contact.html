<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" sizes="180x180" href="images/icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="images/icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/icon.png">
    <title>TIGER POWER 1629_PRICE_LIST</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<style>
.contact-image {
    width: 400px;
    height: 200px;
    object-fit: cover;
    display: block;
    margin: 0 auto;
}


@media (max-width: 600px) {
    .contact-image {
        width: 100%; 
        height: auto; 
    }
}

.thank-you-message {
    display: none;
    color: green;
    font-size: 1.2em;
    text-align: center;
    margin-top: 20px;
}

.message-history {
    margin-top: 20px;
}

.message-history h2 {
    font-size: 1.5em;
    margin-bottom: 10px;
}

.message-history ul {
    list-style-type: none;
    padding: 0;
}

.message-history li {
    background-color: #f9f9f9;
    margin-bottom: 10px;
    padding: 10px;
    border-radius: 5px;
}

#map-container {
    position: relative;
    width: 100%;
    height: 300px;
    max-width: 100%;
    overflow: hidden;
}

#map-container .center-text {
    position: absolute;
    top: -1%;
    left: 50%;
    transform: translateX(-50%);
    font-family: Arial, sans-serif;
    font-size: 20px;
    font-weight: bold;
    color: #2f6eff;
    text-align: center;
    z-index: 10;
    white-space: nowrap;
    padding: 0 10px;
}

iframe {
    border: 0;
    width: 100%;
    height: 100%;
    min-height: 250px;
}


@media only screen and (max-width: 600px) {
    #map-container {
        height: 250px;
    }

    #map-container .center-text {
        font-size: 18px;
    }
}

h1 {
    text-align: center;
    color: #333;
}

label {
    display: block;
    margin-bottom: 8px;
    font-size: 16px;
    color: #333;
}

input, textarea {
    width: 100%;
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 14px;
}

button {
    padding: 10px 20px;
    background-color: #4CAF50;
    color: #fff;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
}

button:hover {
    background-color: #45a049;
}

#imagePreviewContainer {
    width: 100%;
    margin-top: 10px;
}

#thankYouMessage {
    text-align: center;
    font-size: 18px;
    margin-top: 20px;
    display: none;
}

#messageHistory {
    margin-top: 30px;
}

#historyList {
    list-style-type: none;
    padding: 0;
}

#historyHeader {
    font-weight: bold;
    margin-bottom: 10px;
}

 
@media (max-width: 767px) {
    .contact-form {
        padding: 15px;
    }

    input, textarea {
        font-size: 16px;
    }

    button {
        width: 100%;
        font-size: 16px;
    }

    #uploadImageButton, #resetButton {
        width: 100%;
        margin-bottom: 10px;
    }

    #messageHistory {
        margin-top: 20px;
    }
}

@media (max-width: 480px) {
    h1 {
        font-size: 22px;
    }

    input, textarea {
        font-size: 15px;
    }

    button {
        font-size: 16px;
    }

    .contact-image {
        width: 100%;
        height: auto; 
    }
}

@media (min-width: 1024px) {
    .contact-form {
        padding: 30px;
    }

    button {
        font-size: 18px;
    }

    input, textarea {
        font-size: 16px;
    }

    #uploadImageButton, #resetButton {
        font-size: 16px;
    }
}
.nav-link{
margin-top: 5px;
}
#resetButton {
    padding: 10px 20px;
    border: 2px solid transparent; 
    border-radius: 5px;
    background-color: rgb(25, 165, 41); 
    color: #fff3f3; 
    cursor: pointer;
    transition: border-color 0.3s ease; 
}

#resetButton:hover {
    
    border-color: orange; 
}
#uploadImageButton {
    padding: 10px 20px;
    border: 2px solid #3498db;
    background-color: #ffffff;
    color: rgb(0, 0, 0);
    border-radius: 5px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 8px; 
}
#uploadIcon {
    width: 20px; 
    height: 20px; 
}

#uploadImageButton:hover {
    background-color: #2980b9;
}

#uploadImageInput {
    display: none; 
}
#resetButton {
    padding: 10px 20px;
    border: 2px solid #3498db;
    background-color: rgb(255, 255, 255);
    color: #333;
    border-radius: 5px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 8px; 
}

.clear-icon {
    width: 20px; 
    height: 20px; /
}

#resetButton:hover {
    border-color: orange;
    background-color: rgb(216, 214, 232);
}

#historyList {
    list-style-type: none;
}

#historyHeader {
    font-weight: bold;
}
#sendMessageButton {
    padding: 10px 20px;
    border: 2px solid #3498db; 
    background-color: rgb(62, 67, 195);
    color: #ffffff;
    border-radius: 5px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 8px; 
    transition: border-color 0.3s ease, background-color 0.3s ease;
}

.send-icon {
    width: 20px; 
    height: 20px; 
}

#sendMessageButton:hover {
    border-color: #085eff; 
    background-color: #3c02a9; 
}

#sendMessageButton:active {
    background-color: #0d1c6f; 
    color: white; 
}
#imagePreviewContainer {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.image-wrapper {
    position: relative;
    width: 100px;
    height: 100px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.uploaded-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
}

.remove-button {
    position: absolute;
    top: 5px;
    right: 5px;
    background-color: red;
    color: white;
    border: none;
    border-radius: 50%;
    padding: 5px 10px;
    font-size: 12px;
    cursor: pointer;
}

.remove-button:hover {
    background-color: darkred;
}

#uploadIcon {
    width: 20px;
    height: 20px;
    margin-right: 8px;
}

@media screen and (max-width: 600px) {
    .image-wrapper {
        width: 80px; 
        height: 80px;
    }

    .remove-button {
        font-size: 10px;
        padding: 3px 6px;
    }

    #uploadImageButton {
        padding: 8px 16px; 
        font-size: 14px;
    }

    #uploadIcon {
        width: 18px; 
        height: 18px;
    }
}

</style>
<script>
function handleImageUpload(event) {
    const files = event.target.files;
    const container = document.getElementById('imagePreviewContainer');

    container.innerHTML = '';

    for (let i = 0; i < files.length; i++) {
        const file = files[i];
        
        const reader = new FileReader();
        
        reader.onload = function (e) {

            const imagePreview = document.createElement('div');
            imagePreview.classList.add('image-preview');
            const img = document.createElement('img');
            img.src = e.target.result;
            img.alt = 'Image Preview';
            const deleteButton = document.createElement('button');
            deleteButton.textContent = 'X';
            deleteButton.classList.add('delete-button');
            deleteButton.onclick = function () {
                imagePreview.remove(); 
            };

            imagePreview.appendChild(img);
            imagePreview.appendChild(deleteButton);

            container.appendChild(imagePreview);
        };

        reader.readAsDataURL(file);
    }
}

document.getElementById('uploadImageInput').addEventListener('change', handleImageUpload);

</script>
<body>
    <header>
        <div class="header-title">TIGER POWER</div>
        <nav>
            <a href="index.html" class="nav-link">Home</a>
            <ul>
                <a href="contact.html" class="nav-link">Contact</a>
        </nav>
    </header>
    <p>
        <img src="images/contact.png" alt="contact" class="contact-image">
    </p>
    <main>
        <section class="contact-form">
            <h1>Contact Us</h1>
            <form id="contactForm" action="submit_form.php" method="post">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>

                <label for="phone">Phone Number:</label>
                <input type="tel" id="phone" name="phone" required> 

                <label for="email">Email *Optional* :</label>
                <input type="email" id="email" name="email">

                <label for="message">Message:</label>
                <textarea id="message" name="message" rows="4" required></textarea>

                <div id="imagePreviewContainer"></div><br>
                <input type="file" id="uploadImageInput" accept="image/*" style="display: none;" multiple>

                <button type="button" id="uploadImageButton">
                    <img src="live-chat/upload.png" alt="Upload Image" id="uploadIcon" class="upload-icon"> Upload Image
                </button>
                
                <button type="submit" id="sendMessageButton">
                    <img src="live-chat/upload (1).png" alt="Send Message Icon" class="send-icon"> Send Message
                </button>
                
            </form>
            <div id="thankYouMessage" class="thank-you-message">Thanks for your message!</div>
            <div id="messageHistory" class="message-history">
                <h2>Message History</h2>
                <div class="clear">
                    <button type="button" id="resetButton">
                        <img src="live-chat/bin.png" alt="Clear History Icon" class="clear-icon"> Clear History
                    </button>
                </div>
                <ul id="historyList">
                    <li id="historyHeader">History of Sent Messages</li>
                </ul>
            </div>
            
        </section><br>
    </main>
    <script>
        let messages = JSON.parse(localStorage.getItem('messageHistory')) || [];

       document.getElementById('uploadImageButton').addEventListener('click', function() {
    document.getElementById('uploadImageInput').click();
});

document.getElementById('uploadImageInput').addEventListener('change', handleImageUpload);

function handleImageUpload(event) {
    const files = event.target.files;
    const previewContainer = document.getElementById('imagePreviewContainer');
    previewContainer.innerHTML = '';
    for (let i = 0; i < files.length; i++) {
        const file = files[i];
        const reader = new FileReader();

        reader.onload = function (e) {

            const imgWrapper = document.createElement('div');
            imgWrapper.style.position = 'relative'; 
            const img = document.createElement('img');
            img.src = e.target.result;
            img.style.width = '120px'; 
            img.style.marginRight = '10px';

            const removeButton = document.createElement('button');
            removeButton.textContent = 'Remove';
            removeButton.style.position = 'absolute';
            removeButton.style.top = '5px';
            removeButton.style.right = '5px';
            removeButton.style.backgroundColor = 'red';
            removeButton.style.color = 'white';
            removeButton.style.border = 'none';
            removeButton.style.cursor = 'pointer';
            removeButton.onclick = function() {
                imgWrapper.remove(); 
            };

            imgWrapper.appendChild(img);
            imgWrapper.appendChild(removeButton);
            previewContainer.appendChild(imgWrapper);
        };

        reader.readAsDataURL(file);
    }
}


        document.getElementById('resetButton').addEventListener('click', function () {
            document.getElementById('contactForm').reset();
            localStorage.removeItem('messageHistory');
            document.getElementById('historyList').innerHTML = '<li id="historyHeader">History of Sent Messages</li>';
            document.getElementById('imagePreviewContainer').innerHTML = ""; 
            alert('Form and history reset successfully!');
        });

        document.getElementById('contactForm').addEventListener('submit', function (event) {
            event.preventDefault();
            const originalTitle = document.title;
            document.title = "Customer sent message by website Tiger Power";

            // Get input values
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;  
            const message = document.getElementById('message').value;
            const files = document.getElementById('uploadImageInput').files;
            const timestamp = new Date().getTime();

            const botToken = '7687079277:AAH62misBqfMKOCE8KCU2G3Il6_yKA_e0_A';
            const chatId = '-1002407573655';   
            const threadId = 1384;              

            const telegramMessage = `*Customer message from Website Tiger Power:*\n` +
                `*Name:* ${name}\n` +
                `*Email:* ${email || 'N/A'}\n` +
                `*Phone:* ${phone}\n` +  
                `*Message:* ${message}`;


            fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: chatId, text: telegramMessage, parse_mode: 'Markdown', message_thread_id: threadId })
            }).then(response => response.json())
                .then(data => {
                    if (data.ok) {
                        console.log('Message sent successfully to Telegram');
                        messages.push({ name, email, phone, message, timestamp });  
                        localStorage.setItem('messageHistory', JSON.stringify(messages));
                        updateMessageHistory();

                        if (files.length > 0) {
                            const imagePromises = Array.from(files).map(file => sendImageToTelegram(file, botToken, chatId, threadId));
                            return Promise.all(imagePromises);
                        }
                    } else {
                        console.error('Error sending message to Telegram:', data);
                    }
                }).then(() => {
                    const thankYouMessage = document.getElementById('thankYouMessage');
                    thankYouMessage.style.display = 'block';
                    setTimeout(() => { thankYouMessage.style.display = 'none'; }, 5000);
                }).catch(error => console.error('Error:', error))
                .finally(() => {
                    setTimeout(() => {
                        document.title = originalTitle;
                    }, 5000);
                    document.getElementById('contactForm').reset();
                    document.getElementById('imagePreviewContainer').innerHTML = "";
                });
        });

        function sendImageToTelegram(file, botToken, chatId, threadId) {
            const formData = new FormData();
            formData.append('chat_id', chatId);
            formData.append('photo', file);
            formData.append('message_thread_id', threadId);  // Attach thread ID here

            return fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                method: 'POST',
                body: formData
            }).then(response => response.json())
                .then(data => {
                    if (data.ok) {
                        console.log('Image sent successfully to Telegram');
                    } else {
                        console.error('Error sending image to Telegram:', data);
                    }
                }).catch(error => console.error('Error:', error));
        }

        function updateMessageHistory() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '<li id="historyHeader">History of Sent Messages</li>';
            messages.slice().reverse().forEach((msg, index) => {
                const listItem = document.createElement('li');
                const date = new Date(msg.timestamp);
                const formattedDate = `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
                listItem.textContent = `${messages.length - index}. [${formattedDate}] Name: ${msg.name}, Email: ${msg.email || 'N/A'}, Phone: ${msg.phone}, Message: ${msg.message}`;
                historyList.appendChild(listItem);
            });
        }
        updateMessageHistory();
    </script>

    <div id="map-container">
        <div class="center-text">Company Location</div><br>
        <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2608.6841750659773!2d104.87191124746685!3d11.579786345710083!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3109518da15b27a3%3A0xab1e5a78bd2358c6!2s162%20Street%201015%2C%20Phnom%20Penh!5e0!3m2!1sen!2skh!4v1737010094769!5m2!1sen!2skh"
            width="100%" height="450" style="border:0;" allowfullscreen="false" loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>

    <script src="script.js"></script>
    <script src="https://static.elfsight.com/platform/platform.js" data-use-service-core defer></script>

</body>
<script>
    document.addEventListener('contextmenu', function (e) {
        e.preventDefault();
    });

    document.addEventListener('keydown', function (e) {
        if (e.key === 'F12') {
            e.preventDefault();
        }

        if (e.ctrlKey && e.key === 'u') {
            e.preventDefault();
        }

        if (e.ctrlKey && e.shiftKey && e.key === 'I') {
            e.preventDefault();
        }
    });
    window.addEventListener('keydown', function (e) {
        if (e.keyCode == 123) {
            e.preventDefault();
        }
    });
    document.addEventListener('selectstart', function (e) {
        e.preventDefault();
    });

    document.onkeydown = function (e) {
        if (e.ctrlKey && (e.key === 'u' || e.key === 'U')) {
            e.preventDefault();
        } else if (e.key === 'F12') {
            e.preventDefault();
        } else if (e.ctrlKey && e.shiftKey && e.key === 'I') {
            e.preventDefault();
        }
    }
</script>
<script>
    if (window.history && window.history.pushState) {
        window.history.pushState('', '', '/');
    }
</script>

<footer>
    <p>&copy; TIGER POWER - All Rights Reserved 2024</p>
</footer>

</html>